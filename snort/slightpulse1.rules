# Copyright 2021 by FireEye, Inc.
# You may not use this file except in compliance with the license. The license should have been received with this file.

alert tcp any any -> any $HTTP_PORTS ( msg:"APT.Webshell.PL.SLIGHTPULSE.noalert"; flow:to_server; flowbits:noalert; flowbits:isnotset,fb_nopulse; content:"cert="; fast_pattern; content:"md5="; pcre:"/(?:^|\x0d\x0a\x0d\x0a)(?:cert|md5)=[A-Za-z0-9+/]{16}/"; flowbits:set,fb_nopulse; sid:99999906; rev:4; priority:90; )

alert tcp any $HTTP_PORTS -> any any ( msg:"APT.Webshell.PL.SLIGHTPULSE.1"; flow:to_client; flowbits:isset,fb_nopulse; content:"HTTP/1."; depth:7; content:" 200"; distance:1; within:4; content:"|0d 0a|"; distance:0; within:5; content:"|0d 0a|Cache-Control: no-cache|0d 0a|"; content:"|0d 0a|Content-Type: text/html|0d 0a 0d 0a|"; fast_pattern; content:!"<br>"; reference:date_created,2020-04-01; sid: 99999907; )